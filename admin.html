<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin - Charvik Programs</title>
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 40px 20px;
      text-align: center;
    }
    h1 { color: #00aaff; font-size: 36px; text-shadow: 0 0 10px #007bff; }
    input[type="password"], input[type="file"] {
      padding: 12px; border-radius: 10px; background: #111; border: 2px solid #007bff;
      color: #fff; width: 250px; text-align: center;
    }
    button { background: #007bff; color:#fff; border:none; padding:12px 25px;
      font-size:16px; border-radius:8px; cursor:pointer; }
    .hidden{ display:none; }
    #output{ margin-top:20px; }
    .link-box{ background:#111; padding:12px; margin-top:15px; border-radius:8px; }
  </style>
</head>
<body>

<h1>Admin Panel - Charvik Programs</h1>

<div id="loginBox">
  <p>Enter 10-digit Admin Passcode üîí</p>
  <input type="password" id="passcodeInput" maxlength="10" placeholder="**********" />
  <br><br>
  <button onclick="checkPasscode()">Unlock</button>
  <p id="loginMessage" style="color:red;margin-top:10px;"></p>
</div>

<div id="uploadBox" class="hidden">
  <p>Select images to upload üì∏</p>
  <input type="file" id="fileInput" accept="image/*" multiple>
  <br><br>
  <button onclick="uploadImages()">Upload</button>
  <div id="output"></div>
</div>

<script>
const ADMIN_PASSCODE = "7337813468";
const BACKEND_URL = "https://admin-img-backend.onrender.com/upload";
const IMGBB_API_KEY = "13c92fea16f5a4435ebdd770bebd783a";

function checkPasscode() {
  if (document.getElementById("passcodeInput").value === ADMIN_PASSCODE) {
    document.getElementById("loginBox").classList.add("hidden");
    document.getElementById("uploadBox").classList.remove("hidden");
  } else {
    document.getElementById("loginMessage").textContent = "‚ùå Invalid passcode!";
  }
}

async function uploadToImgbb(file) {
  const form = new FormData();
  form.append("image", file);

  const res = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
    method: "POST",
    body: form
  });

  const data = await res.json();
  return data.data.url;
}

async function uploadImages() {
  const files = document.getElementById("fileInput").files;
  const output = document.getElementById("output");
  output.innerHTML = "Uploading to imgbb...";

  if (files.length === 0) {
    output.innerHTML = "‚ùå No images selected.";
    return;
  }

  const urls = [];
  for (let f of files) {
    const url = await uploadToImgbb(f);
    urls.push(url);
  }

  output.innerHTML = "Saving to server...";

  const res = await fetch(BACKEND_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ images: urls })
  });

  const data = await res.json();

  if (!data.success) {
    output.innerHTML = "‚ùå Server error.";
    return;
  }

  output.innerHTML = `
    <div class="link-box">
      <h3>‚úÖ Uploaded Successfully!</h3>
      Visitor Code:<br><strong>${data.code}</strong><br><br>
      ${urls.map(u => `<a href="${u}" target="_blank">${u}</a><br>`).join("")}
    </div>
  `;
}
</script>
</body>
</html>

